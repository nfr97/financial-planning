<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta
      name="description"
      content="Privacy-focused financial planning tools that run entirely in your browser. Analyze spending, plan budgets, and simulate retirement scenarios."
    />
    <title>Financial Planning Suite - Privacy-First Tools</title>
    <script src="shared.js?v=20251229"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell,
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        color: #333;
      }

      .container {
        max-width: 1100px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        overflow: hidden;
      }

      header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 40px 30px;
        text-align: center;
      }

      header h1 {
        font-size: 2.4em;
        margin-bottom: 12px;
        line-height: 1.2;
      }

      header p {
        font-size: 1.2em;
        opacity: 0.95;
      }

      .privacy-badge {
        display: inline-block;
        margin-top: 15px;
        padding: 8px 16px;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 20px;
        font-size: 0.9em;
        font-weight: 500;
      }

      .content {
        padding: 40px 30px;
      }

      /* Development Warning Banner */
      .dev-warning {
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        border-bottom: 3px solid #d97706;
        padding: 16px 20px;
        text-align: center;
        color: #92400e;
        font-weight: 600;
        font-size: 0.95em;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        position: relative;
        z-index: 1000;
      }

      .dev-warning-icon {
        font-size: 1.3em;
        margin-right: 8px;
        vertical-align: middle;
      }

      .dev-warning-text {
        display: inline-block;
        vertical-align: middle;
      }

      .dev-warning a {
        color: #78350f;
        text-decoration: underline;
        font-weight: 700;
      }

      .dev-warning a:hover {
        color: #451a03;
      }

      /* Navigation Tabs */
      .nav-tabs {
        max-width: 1100px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        background: transparent;
        gap: 8px;
        padding: 0 20px;
      }

      .nav-tab {
        padding: 14px 16px;
        text-align: center;
        text-decoration: none;
        color: rgba(255, 255, 255, 0.7);
        font-weight: 500;
        font-size: 0.95em;
        border-bottom: 2px solid transparent;
        transition: all 0.2s;
        background: transparent;
      }

      .nav-tab:hover {
        color: rgba(255, 255, 255, 0.95);
      }

      .nav-tab.active {
        color: white;
        border-bottom-color: white;
        font-weight: 600;
      }

      /* Tool Cards */
      .tools-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 25px;
        margin-bottom: 30px;
      }

      .tool-card {
        background: #f9f9f9;
        border-radius: 12px;
        padding: 30px 25px;
        text-align: center;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        text-decoration: none;
        color: inherit;
        display: flex;
        flex-direction: column;
      }

      .tool-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        border-color: #667eea;
        background: white;
      }

      .tool-card:focus {
        outline: 3px solid #667eea;
        outline-offset: 2px;
      }

      .tool-icon {
        font-size: 3em;
        margin-bottom: 15px;
      }

      .tool-card h2 {
        font-size: 1.4em;
        color: #333;
        margin-bottom: 8px;
      }

      .tool-tagline {
        font-size: 1.05em;
        color: #667eea;
        font-weight: 600;
        margin-bottom: 15px;
      }

      .tool-features {
        list-style: none;
        text-align: left;
        margin-bottom: 20px;
        flex-grow: 1;
      }

      .tool-features li {
        padding: 6px 0;
        color: #555;
        font-size: 0.95em;
        position: relative;
        padding-left: 20px;
      }

      .tool-features li::before {
        content: '‚úì';
        position: absolute;
        left: 0;
        color: #10b981;
        font-weight: bold;
      }

      .tool-cta {
        display: inline-block;
        padding: 12px 24px;
        background: #667eea;
        color: white;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.95em;
        transition: background 0.3s;
        text-decoration: none;
      }

      .tool-card:hover .tool-cta {
        background: #5568d3;
      }

      /* Workflow Cycle */
      .workflow-cycle {
        background: linear-gradient(135deg, #f0f4ff 0%, #e8edff 100%);
        border: 2px solid #667eea;
        padding: 30px 25px;
        border-radius: 12px;
        margin-bottom: 30px;
      }

      .workflow-cycle h3 {
        font-size: 1.3em;
        color: #333;
        margin-bottom: 12px;
        text-align: center;
      }

      .workflow-cycle > p {
        color: #555;
        font-size: 1em;
        line-height: 1.6;
        text-align: center;
        margin-bottom: 25px;
      }

      .cycle-diagram {
        display: grid;
        grid-template-columns: 1fr auto 1fr auto 1fr auto 1fr;
        gap: 15px;
        align-items: center;
        margin-bottom: 20px;
      }

      .cycle-step {
        background: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        border: 2px solid transparent;
        transition: all 0.3s;
      }

      .cycle-step:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 16px rgba(102, 126, 234, 0.25);
        border-color: #667eea;
      }

      .cycle-number {
        width: 36px;
        height: 36px;
        background: #667eea;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 1.2em;
        margin: 0 auto 10px;
      }

      .cycle-title {
        font-size: 1.1em;
        font-weight: 700;
        color: #333;
        margin-bottom: 8px;
      }

      .cycle-desc {
        font-size: 0.85em;
        color: #666;
        line-height: 1.4;
      }

      .cycle-arrow {
        color: #667eea;
        font-size: 2em;
        font-weight: 700;
      }

      .cycle-arrow-return {
        color: #10b981;
      }

      .continue-suggestion {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        margin-top: 20px;
      }

      .continue-suggestion h4 {
        font-size: 1.1em;
        margin-bottom: 12px;
      }

      .continue-suggestion p {
        font-size: 0.95em;
        margin-bottom: 15px;
        opacity: 0.95;
      }

      .continue-btn {
        display: inline-block;
        background: white;
        color: #10b981;
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.2s;
      }

      .continue-btn:hover {
        background: #f0fdf4;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      /* Footer */
      footer {
        background: #f5f5f5;
        padding: 24px 30px;
        border-top: 1px solid #e0e0e0;
        text-align: center;
        color: #666;
        font-size: 0.95em;
        line-height: 1.6;
      }

      footer strong {
        color: #333;
      }

      footer a {
        color: #667eea;
        text-decoration: none;
        font-weight: 600;
      }

      footer a:hover {
        text-decoration: underline;
      }

      footer .disclaimer {
        font-size: 0.85em;
        color: #888;
        margin-bottom: 12px;
      }

      /* Accessibility */
      .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: #667eea;
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        z-index: 100;
        font-weight: 600;
      }

      .skip-link:focus {
        top: 0;
      }

      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      *:focus-visible {
        outline: 3px solid #667eea;
        outline-offset: 2px;
      }

      /* Responsive */
      @media (max-width: 900px) {
        .tools-grid {
          grid-template-columns: 1fr;
          gap: 20px;
        }

        .tool-card {
          padding: 25px 20px;
        }

        .cycle-diagram {
          grid-template-columns: 1fr;
          gap: 10px;
        }

        .cycle-arrow {
          transform: rotate(90deg);
          margin: 10px auto;
        }

        .cycle-arrow-return {
          transform: none;
        }
      }

      @media (max-width: 768px) {
        .nav-tabs {
          padding: 0 10px;
          gap: 4px;
        }

        .nav-tab {
          padding: 12px 8px;
          font-size: 0.85em;
        }

        header {
          padding: 30px 20px;
        }

        header h1 {
          font-size: 1.8em;
        }

        header p {
          font-size: 1em;
        }

        .content {
          padding: 25px 20px;
        }

        .workflow-cycle {
          padding: 20px 15px;
        }

        .cycle-step {
          padding: 15px;
        }
      }
    </style>
  </head>
  <body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Development Warning Banner -->
    <div class="dev-warning" role="alert">
      <span class="dev-warning-icon">‚ö†Ô∏è</span>
      <span class="dev-warning-text">
        <strong>BETA VERSION</strong> - This tool is under active development. Features may change
        and bugs may exist.
        <a
          href="https://github.com/marble-stack/financial-planning/issues"
          target="_blank"
          rel="noopener"
          >Report issues on GitHub</a
        >
      </span>
    </div>

    <nav class="nav-tabs" role="navigation" aria-label="Main navigation">
      <a href="income-allocation.html" class="nav-tab">Budget Planner</a>
      <a href="transaction-analyzer.html" class="nav-tab">Spending Tracker</a>
      <a href="retirement-simulator.html" class="nav-tab">Retirement Forecast</a>
    </nav>

    <div class="container" role="document">
      <header role="banner">
        <h1>Financial Planning Suite</h1>
        <p>Privacy-focused tools that run entirely in your browser</p>
        <div class="privacy-badge">Your data never leaves your device</div>
      </header>

      <main id="main-content" class="content" role="main">
        <div class="tools-grid">
          <a href="income-allocation.html" class="tool-card" aria-label="Open Budget Planner">
            <div class="tool-icon" aria-hidden="true">üí∞</div>
            <h2>Budget Planner</h2>
            <p class="tool-tagline">Allocate Your Income</p>
            <ul class="tool-features">
              <li>Four-category budget framework</li>
              <li>Guilt-free spending approach</li>
              <li>Real-time calculations</li>
              <li>Pre-built budget presets</li>
            </ul>
            <span class="tool-cta">Plan Your Budget</span>
          </a>

          <a href="transaction-analyzer.html" class="tool-card" aria-label="Open Spending Tracker">
            <div class="tool-icon" aria-hidden="true">üìä</div>
            <h2>Spending Tracker</h2>
            <p class="tool-tagline">Track Against Your Goals</p>
            <ul class="tool-features">
              <li>Import bank/credit card CSVs</li>
              <li>Auto-categorize transactions</li>
              <li>Compare actual vs. target</li>
              <li>Detect duplicate transfers</li>
            </ul>
            <span class="tool-cta">Track Spending</span>
          </a>

          <a
            href="retirement-simulator.html"
            class="tool-card"
            aria-label="Open Retirement Simulator"
          >
            <div class="tool-icon" aria-hidden="true">üéØ</div>
            <h2>Retirement Simulator</h2>
            <p class="tool-tagline">Project Your Future</p>
            <ul class="tool-features">
              <li>10,000+ Monte Carlo scenarios</li>
              <li>Social Security calculator</li>
              <li>Life events modeling</li>
              <li>Tax-aware projections</li>
            </ul>
            <span class="tool-cta">Simulate Retirement</span>
          </a>
        </div>

        <section class="workflow-cycle" aria-label="Planning cycle">
          <h3>üîÑ Your Financial Planning Cycle</h3>
          <p>
            These tools work together in a continuous cycle of planning, tracking, and refining.
            Start anywhere, but complete all three for the best results.
          </p>
          <div class="cycle-diagram">
            <div class="cycle-step cycle-plan">
              <div class="cycle-number">1</div>
              <div class="cycle-title">Plan</div>
              <div class="cycle-desc">Set your ideal budget allocations</div>
            </div>
            <div class="cycle-arrow">‚Üí</div>
            <div class="cycle-step cycle-track">
              <div class="cycle-number">2</div>
              <div class="cycle-title">Track</div>
              <div class="cycle-desc">Compare actual vs. planned</div>
            </div>
            <div class="cycle-arrow">‚Üí</div>
            <div class="cycle-step cycle-project">
              <div class="cycle-number">3</div>
              <div class="cycle-title">Project</div>
              <div class="cycle-desc">Simulate retirement outcomes</div>
            </div>
            <div class="cycle-arrow cycle-arrow-return">‚Üª</div>
            <div class="cycle-step cycle-refine">
              <div class="cycle-number">4</div>
              <div class="cycle-title">Refine</div>
              <div class="cycle-desc">Adjust based on insights</div>
            </div>
          </div>
          <div id="continueSuggestion" class="continue-suggestion" style="display: none"></div>
        </section>
      </main>

      <footer role="contentinfo">
        <p class="disclaimer">
          <strong>Disclaimer:</strong> These tools are for educational purposes only and do not
          constitute financial advice. Please consult with a qualified financial advisor for
          personalized planning.
        </p>
        <p>
          <strong>Privacy First:</strong> All calculations happen in your browser. No accounts, no
          servers, no data collection.
          <br />
          Use the session toolbar on any tool page to save/load your data as a local file.
        </p>
        <p>
          <a href="income-allocation.html">Budget Planner</a> |
          <a href="transaction-analyzer.html">Spending Tracker</a> |
          <a href="retirement-simulator.html">Retirement Forecast</a>
        </p>
      </footer>
    </div>

    <script>
      // Initialize page
      DOMUtils.ready(() => {
        // Initialize session toolbar
        if (typeof SessionManager !== 'undefined') {
          SessionManager.initToolbar(
            () => ({}),
            (result) => {
              SessionManager.showToast(
                `Session loaded! ${result.imported.length} items restored.`,
                'success'
              );
              updateContinueSuggestion();
              StatusBar.update();
            }
          );
        }

        // Initialize status bar
        if (typeof StatusBar !== 'undefined') {
          StatusBar.init();
        }

        // Show "Continue where you left off" suggestion
        updateContinueSuggestion();
      });

      function updateContinueSuggestion() {
        const state = CrossToolState.getAllState();
        const { budget, spending, retirement } = state;

        const suggestionDiv = document.getElementById('continueSuggestion');
        if (!suggestionDiv) return;

        let nextStep = null;
        let nextStepUrl = null;
        let message = '';

        // Determine next step
        if (!budget) {
          nextStep = 'Budget Planner';
          nextStepUrl = 'income-allocation.html';
          message = 'Start by setting up your ideal budget allocations';
        } else if (!spending) {
          nextStep = 'Spending Tracker';
          nextStepUrl = 'transaction-analyzer.html';
          message = 'Upload your transactions to track actual spending';
        } else if (!retirement || retirement.successRate === 0) {
          nextStep = 'Retirement Simulator';
          nextStepUrl = 'retirement-simulator.html';
          message = 'Run a simulation to project your retirement outcome';
        } else {
          // All steps complete - suggest refinement
          const daysSinceUpdate = spending.lastUpdated
            ? Math.floor(
                (Date.now() - new Date(spending.lastUpdated).getTime()) / (1000 * 60 * 60 * 24)
              )
            : 999;

          if (daysSinceUpdate > 7) {
            nextStep = 'Spending Tracker';
            nextStepUrl = 'transaction-analyzer.html';
            message = `It's been ${daysSinceUpdate} days since your last update. Upload new transactions to stay current.`;
          } else if (retirement.successRate < 90) {
            nextStep = 'Review Your Plan';
            nextStepUrl = '#';
            message = `Your retirement success rate is ${retirement.successRate}%. Click to see recommendations.`;
          } else {
            suggestionDiv.style.display = 'none';
            return;
          }
        }

        suggestionDiv.innerHTML = `
                <h4>üìç Continue Where You Left Off</h4>
                <p>${message}</p>
                <a href="${nextStepUrl}" class="continue-btn">Go to ${nextStep} ‚Üí</a>
            `;
        suggestionDiv.style.display = 'block';

        // Override click to open refinement modal when success rate is low
        if (nextStepUrl === '#') {
          const btn = suggestionDiv.querySelector('.continue-btn');
          if (btn) {
            btn.addEventListener('click', (e) => {
              e.preventDefault();
              if (typeof RefinementModal !== 'undefined') {
                RefinementModal.open();
              }
            });
          }
        }
      }
    </script>
  </body>
</html>
